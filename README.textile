h1. Xsrf_guard

A PHP class for Cross-Site Request Forgery (XSRF) protection.

h2. Overview

This class offers a simple way of protecting forms against XSRF-attacks.

Looking around for info on protecting against XSRF in PHP, I found an existing class for XSRF protection, written by David Parrish, available at "Github":https://github.com/dparrish/phpxsrfprotect.

This class is pretty similar to above mentioned, but it's a bit more flexible in that it allows hooking in custom callbacks for token generation and validation.

h2. Installation and usage

Download the source from Github: http://github.com/dfh/xsrf_guard/. Then include it, something like so:

bc.. <?php

require 'lib/xsrf_guard.php';

p. Basic usage of this class would go something like this:

bc.. <?php

$xg = new Xsrf_guard();
$xg->key( 'topsecret' ); # your unique, secret key
# $xg->userdata( $uid ); # OPTIONAL: user-specific data for extra protection
# $xg->timeout( 3600 ); # OPTIONAL: timeout. in seconds, default is 900.

if ( $_SERVER['REQUEST_METHOD'] == 'POST' ) {
  # obviously this is just a demo and not for production 
  if ( $xsrf_guard->is_valid( $_POST ) )
    echo 'Nice! Your request was valid.';
  else
    die( 'Uh-oh! Invalid request!!! (' . $xsrf_guard->error() . ')' );
}

p. And of course you need to add the XSRF guard field to the form that you wish to protect. This is easiest done by using the method xsrf_guard_field():

bc.. <form action="" method="post">
  <input type="submit" value="Submit" />
  <?= $xg->xsrf_guard_field(); ?>
</form>

h2. Known issues

None, so far.

h2. Meta

Copyright 2010, 2011 David HÃ¶gberg (david@hgbrg.se, http://david.hgbrg.se)

This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License along with this program.  If not, see <http://www.gnu.org/licenses/>.
